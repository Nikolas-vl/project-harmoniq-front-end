import{i as f,r as a,a as C,d as D,j as e,V as j}from"./index-BcFpteH1.js";import{T}from"./TestNav-Bnav2Eya.js";const w=({page:t,perPage:r}={})=>f.get("/users",{params:{page:t,perPage:r}}),E=t=>f.get(`/users/${t}`),N=(t,r)=>f.post(`/users/${t}/save/${r}`),k=(t=1,r=20)=>{const[o,d]=a.useState([]),[l,c]=a.useState(null),[u,n]=a.useState(!1);return a.useEffect(()=>{(async()=>{n(!0);try{const g=await w({page:t,perPage:r});d(g.data.users),c(g.data.paginationData)}catch(g){console.error("Failed to fetch users:",g)}finally{n(!1)}})()},[t,r]),{users:o,paginationData:l,isLoading:u}},F=t=>{const[r,o]=a.useState(null),[d,l]=a.useState([]),[c,u]=a.useState(!1);return a.useEffect(()=>{if(!t)return;(async()=>{u(!0);try{const i=await E(t);o(i.data.user),l(i.data.userArticles)}catch(i){console.error("Failed to fetch user info:",i)}finally{u(!1)}})()},[t]),{user:r,userArticles:d,isLoading:c}},G=()=>{const[t,r]=a.useState(!1);return{saveArticle:async(d,l)=>{r(!0);try{await N(d,l)}catch(c){throw console.error("Failed to save article:",c),c}finally{r(!1)}},isLoading:t}},M=()=>{const[t,r]=a.useState(1),[o,d]=a.useState(20),l=C(D),{users:c,isLoading:u,paginationData:n}=k(t,o),[i,g]=a.useState(""),[p,v]=a.useState(""),[h,m]=a.useState(""),[y,U]=a.useState(""),{user:x,userArticles:I,isLoading:A}=F(y),{saveArticle:S,isLoading:L}=G(),b=async()=>{if(!(!i||!p))try{await S(i,p),j.success("Article saved!")}catch{j.error("Error saving article.")}},P=()=>{h&&U(h)};return e.jsxs("div",{style:{padding:"1rem"},children:[e.jsx(T,{}),e.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:"1rem",alignItems:"center"},children:[e.jsxs("div",{style:{display:"flex",gap:"0.5rem",alignItems:"center"},children:[e.jsx("input",{placeholder:"User ID",value:i,onChange:s=>g(s.target.value)}),e.jsx("input",{placeholder:"Article ID",value:p,onChange:s=>v(s.target.value)}),e.jsx("button",{onClick:b,disabled:L,children:"Save Article"})]}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem",alignItems:"center"},children:[e.jsx("input",{placeholder:"User ID",value:h,onChange:s=>m(s.target.value)}),e.jsx("button",{onClick:P,disabled:!h,children:"Get User By ID"})]})]}),e.jsxs("p",{children:["Ur user id is ",l||"ur not loggin"]}),e.jsxs("div",{style:{marginTop:"2rem"},children:[e.jsxs("details",{children:[e.jsxs("summary",{style:{fontWeight:"bold"},children:["All Users (page ",n?.page||1," of"," ",n?.totalPages||1,")"]}),u?e.jsx("p",{children:"Loading users..."}):e.jsxs(e.Fragment,{children:[e.jsx("ul",{children:c.map(s=>e.jsxs("li",{children:[s.name," (",s._id,")"]},s._id))}),e.jsxs("div",{style:{marginTop:"1rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("button",{onClick:()=>r(s=>Math.max(s-1,1)),disabled:!n?.hasPreviousPage,children:"Prev"}),e.jsxs("label",{children:["Users per page:"," ",e.jsx("select",{value:o,onChange:s=>d(Number(s.target.value)),children:[6,12,24,48].map(s=>e.jsx("option",{value:s,children:s},s))})]}),e.jsx("button",{onClick:()=>r(s=>Math.min(s+1,n?.totalPages||s+1)),disabled:!n?.hasNextPage,children:"Next"})]})]})]}),e.jsx("h3",{children:"User Info"}),A?e.jsx("p",{children:"Loading user info..."}):x&&e.jsxs("div",{children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Name:"})," ",x.name]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Saved:"})," ",Array.isArray(x.saved)?x.saved.join(", "):""]}),e.jsx("h4",{children:"Articles:"}),e.jsx("ul",{children:I.map(s=>e.jsx("li",{children:s.title},s._id))})]})]})]})};export{M as default};
