import{r,f as N,j as e,a as p,d as A,v as M,L as x,V as u}from"./index--Li--3xp.js";import{d as B}from"./articlesApi-Do6laUDj.js";import{u as D}from"./useSaveArticle-plwomvfJ.js";import{d as T}from"./usersApi-BGv1Urdy.js";const F="_card_container_bra2c_1",I="_card_image_bra2c_14",W="_unknown_image_bra2c_21",$="_card_author_name_bra2c_35",R="_card_title_bra2c_43",U="_card_description_bra2c_57",Z="_card_button_container_bra2c_71",V="_load_more_link_bra2c_76",d={card_container:F,card_image:I,unknown_image:W,card_author_name:$,card_title:R,card_description:U,card_button_container:Z,load_more_link:V},q="_overlay_c61rp_1",z="_content_c61rp_12",P="_errorTitle_c61rp_22",H="_icon_c61rp_29",O="_textModalWrapper_c61rp_35",G="_btns_c61rp_40",J="_loginBtn_c61rp_45",K="_registerBtn_c61rp_56",c={overlay:q,content:z,errorTitle:P,icon:H,textModalWrapper:O,btns:G,loginBtn:J,registerBtn:K},Q=({isOpen:t,onClose:s})=>{r.useEffect(()=>{const o=h=>{h.key==="Escape"&&s()};return document.addEventListener("keydown",o),()=>document.removeEventListener("keydown",o)},[s]);const i=N();if(!t)return null;const n=()=>{i("/login")},a=()=>{i("/register")},l=o=>{o.target===o.currentTarget&&s()};return e.jsx("div",{className:c.overlay,onClick:l,children:e.jsxs("div",{className:c.content,children:[e.jsx("button",{onClick:s,children:e.jsx("svg",{className:c.icon,width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{d:"M5.25 5.25L12 12M12 12L5.25 18.75M12 12L18.75 18.75M12 12L18.75 5.25",stroke:"#070721",strokeLinecap:"round",strokeLinejoin:"round"})})}),e.jsxs("div",{className:c.textModalWrapper,children:[e.jsx("h2",{className:c.errorTitle,children:"Error while saving"}),e.jsx("p",{className:c.errorText,children:"To save this article, you need to authorize first"}),e.jsxs("div",{className:c.btns,children:[e.jsx("button",{onClick:n,className:c.loginBtn,children:"Login"}),e.jsx("button",{onClick:a,className:c.registerBtn,children:"Register"})]})]})]})})},X="_save_button_x6qpj_7",Y="_saved_button_x6qpj_23",m={save_button:X,saved_button:Y},ee=t=>r.createElement("svg",{width:40,height:40,viewBox:"0 0 41 41",fill:"none",xmlns:"http://www.w3.org/2000/svg",...t},r.createElement("rect",{x:1,y:1.4043,width:39,height:39,rx:19.5,stroke:"currentBorder",fill:"transparent"}),r.createElement("path",{d:"M20.4971 12.4043C21.7607 12.4043 22.9206 12.5252 23.8398 12.665C25.0036 12.8421 25.916 13.6396 26.1758 14.7539C26.4894 16.0991 26.7969 18.1457 26.7441 20.8945C26.6859 23.9276 26.2432 26.1159 25.8164 27.5439C25.701 27.9299 25.4339 28.1286 25.1318 28.1797C24.816 28.233 24.4263 28.1279 24.1094 27.8125C23.5326 27.2383 22.8719 26.6181 22.2627 26.1387C21.9586 25.8994 21.6558 25.686 21.375 25.5303C21.1101 25.3834 20.7995 25.25 20.4971 25.25C20.1993 25.25 19.8783 25.3812 19.5977 25.5254C19.2986 25.679 18.9675 25.8898 18.6289 26.1289C17.9504 26.608 17.1989 27.2287 16.5371 27.8037C16.1878 28.1072 15.7764 28.179 15.4521 28.0908C15.1392 28.0056 14.8752 27.7652 14.7939 27.3467C14.5149 25.9087 14.25 23.7848 14.25 20.9043C14.25 18.0308 14.5461 16.004 14.8408 14.6992C15.085 13.6179 15.9671 12.848 17.1016 12.6729C18.0289 12.5296 19.2091 12.4043 20.4971 12.4043Z",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round"})),te=t=>r.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:1,...t},r.createElement("path",{d:"M3.03919 4.2939C3.01449 4.10866 3.0791 3.92338 3.23133 3.81499C3.9272 3.31953 6.3142 2 12 2C17.6858 2 20.0728 3.31952 20.7687 3.81499C20.9209 3.92338 20.9855 4.10866 20.9608 4.2939L19.2616 17.0378C19.0968 18.2744 18.3644 19.3632 17.2813 19.9821L16.9614 20.1649C13.8871 21.9217 10.1129 21.9217 7.03861 20.1649L6.71873 19.9821C5.6356 19.3632 4.90325 18.2744 4.73838 17.0378L3.03919 4.2939Z"}),r.createElement("path",{d:"M3 5C5.57143 7.66666 18.4286 7.66662 21 5"})),re=({onToggle:t,isDisabled:s,isSaved:i,isOwnArticle:n,onDelete:a,isLoadingDelete:l})=>n?e.jsx("button",{onClick:a,disabled:l,className:m.save_button,children:e.jsx(te,{})}):e.jsx("button",{onClick:t,disabled:s,className:`${m.save_button} ${i?m.saved_button:""}`,children:s?e.jsx("span",{style:{fontSize:"16px",margin:0},children:"✋"}):e.jsx(ee,{})}),se=()=>{const[t,s]=r.useState(!1);return{remove:async n=>{s(!0);try{await B(n)}catch(a){console.error("Failed to delete article:",a)}finally{s(!1)}},isLoading:t}},ne=()=>{const[t,s]=r.useState(!1);return{deleteArticle:async(n,a)=>{s(!0);try{await T(n,a)}catch(l){console.error("Failed to delete saved article:",l)}finally{s(!1)}},isLoading:t}},ae=t=>r.createElement("svg",{width:391,height:280,viewBox:"0 0 391 280",fill:"none",xmlns:"http://www.w3.org/2000/svg",...t},r.createElement("rect",{width:391,height:280,fill:"#9F9F9F"}),r.createElement("path",{d:"M214.371 146.212C214.371 154.788 206.099 161.74 195.897 161.74C185.694 161.74 177.423 154.788 177.423 146.212C177.423 137.635 185.694 130.683 195.897 130.683C206.099 130.683 214.371 137.635 214.371 146.212Z",stroke:"#070707"}),r.createElement("path",{d:"M147.864 167.625L147.864 129.776C147.864 123.416 153.998 118.26 161.565 118.26C166.755 118.26 171.499 115.795 173.82 111.893L176.925 106.673C179.494 102.354 184.747 99.625 190.492 99.625L201.301 99.625C207.047 99.6251 212.299 102.354 214.868 106.673L217.973 111.893C220.294 115.795 225.038 118.26 230.228 118.26C237.795 118.26 243.929 123.416 243.929 129.776V167.625C243.929 174.667 237.138 180.375 228.761 180.375H163.032C154.655 180.375 147.864 174.667 147.864 167.625Z",stroke:"#070707"})),de=({article:t,isBeingLoaded:s,isOwnArticle:i})=>{const n=p(A),a=p(M),[l,o]=r.useState(!1),[h,C]=r.useState(!1),[w,g]=r.useState(!1),{saveArticle:f,isLoading:j}=D(),{deleteArticle:k,isLoading:b}=ne(),{remove:L,isLoading:v}=se(),E=j||b;r.useEffect(()=>{o(a.some(_=>_===t._id))},[t._id,a]);const S=async()=>{if(!n){g(!0);return}try{l?(await k(n,t._id),o(!1),u.success("Removed from saved!")):(await f(n,t._id),o(!0),u.success("Saved!"))}catch(_){u.error("Something went wrong"),console.error(_)}},y=async()=>{try{await L(t._id),C(!0),u.success("Article deleted!")}catch(_){console.error("Failed to delete:",_),u.error("Failed to delete article")}};return s?e.jsx("p",{children:"✋Loading...✋"}):s||h?null:v?e.jsx("p",{children:"✋Deleting...✋"}):e.jsxs(e.Fragment,{children:[e.jsx(Q,{isOpen:w,onClose:()=>g(!1)}),e.jsxs("div",{className:d.card_container,children:[t.image?e.jsx("img",{className:d.card_image,src:t.image,alt:t.desc}):e.jsx(ae,{className:d.unknown_image}),e.jsxs("div",{children:[e.jsx(x,{to:`/authors/${t.ownerId}`,className:d.card_author_name,children:t?.author||"Unknown author"}),e.jsx("h3",{className:d.card_title,children:t.title}),e.jsx("p",{className:d.card_description,children:t.article})]}),e.jsxs("div",{className:d.card_button_container,children:[e.jsx(x,{className:d.load_more_link,to:`/articles/${t._id}`,children:"Learn more"}),e.jsx(re,{onToggle:S,isDisabled:E,isSaved:l,isOwnArticle:i,onDelete:y,isLoadingDelete:v})]})]})]})};export{de as P};
