import{r as o,b as M,c as R,u as L,s as C,d as U,j as e,e as P,L as _,V as l,f as g}from"./index-D2ltbs7f.js";import{a as $}from"./articlesApi-hsqTabP2.js";import{u as F,a as G,b as O,M as W,B as V}from"./useDeleteSavedArticle-BqBqFdtN.js";import{u as z}from"./useGetUserInfo-Bw6HC-kL.js";import"./useLoader-DyngfI2z.js";const H="_page_yy2ql_1",Y="_title_yy2ql_10",J="_image_yy2ql_17",K="_articleWrapper_yy2ql_26",Q="_contentBlock_yy2ql_32",X="_description_yy2ql_36",Z="_sidebar_yy2ql_44",ee="_metaRecommendationsContainer_yy2ql_53",te="_meta_yy2ql_53",se="_authorLink_yy2ql_68",ae="_recommendations_yy2ql_80",re="_recommendationsList_yy2ql_87",ne="_recommendationItem_yy2ql_96",oe="_recText_yy2ql_113",ie="_recTitle_yy2ql_120",ce="_recAuthor_yy2ql_134",le="_arrowButton_yy2ql_147",de="_icon_yy2ql_171",t={page:H,title:Y,image:J,articleWrapper:K,contentBlock:Q,description:X,sidebar:Z,metaRecommendationsContainer:ee,meta:te,authorLink:se,recommendations:ae,recommendationsList:re,recommendationItem:ne,recText:oe,recTitle:ie,recAuthor:ce,arrowButton:le,icon:de},me=s=>{const[i,n]=o.useState(null),[d,a]=o.useState(!1);return o.useEffect(()=>{if(!s)return;(async()=>{a(!0);try{const c=await $(s);n(c.data.data.article)}catch(c){console.error("Failed to fetch article:",c)}finally{a(!1)}})()},[s]),{article:i,isLoading:d}},he=s=>o.createElement("svg",{width:25,height:24,viewBox:"0 0 25 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...s},o.createElement("path",{d:"M5.375 15.125L19.6195 0.875M19.6195 0.875H11.948M19.6195 0.875L19.6196 8.5466",stroke:"#070721",strokeLinecap:"round",strokeLinejoin:"round"})),ue=s=>s.split("/n").map((i,n)=>e.jsxs("span",{children:[i.trim(),e.jsx("br",{})]},n)),_e=3,je=()=>{const{id:s}=M(),i=R(),n=L(C),d=L(U),{article:a,isLoading:y}=me(s),{articles:c=[],isLoading:N}=useGetPopularArticles(8);z(n);const{saveArticle:w,isLoading:A}=F(),{deleteArticle:S,isLoading:k}=G(),{remove:q,isLoading:B}=O(),[p,h]=o.useState(!1),[I,x]=o.useState(!1);o.useEffect(()=>{h(d.some(r=>r===s))},[d,s]);const b=a?.ownerId===n,f=o.useMemo(()=>c.length?c.filter(m=>m._id!==s).sort(()=>.5-Math.random()).slice(0,_e):[],[c,s]),T=A||k,D=async()=>{if(!n){x(!0);return}try{p?(await S(n,s),h(!1),l.success("Removed from saved!"),i(g())):(await w(n,s),h(!0),l.success("Saved!"),i(g()))}catch(r){l.error("Something went wrong"),console.error(r)}},E=async()=>{try{await q(s),l.success("Article deleted!"),i(g())}catch(r){console.error("Failed to delete:",r),l.error("Failed to delete article")}};if(y)return e.jsx(P,{fullScreen:!0});if(!a)return e.jsx("p",{children:"Article not found"});let j="Unknown date";if(a.date){const r=new Date(a.date);isNaN(r)||(j=r.toLocaleDateString(void 0,{year:"numeric",month:"long",day:"numeric"}))}return e.jsxs(e.Fragment,{children:[e.jsx(W,{isOpen:I,onClose:()=>x(!1)}),e.jsx("div",{className:`container ${t.articlePage}`,children:e.jsxs("div",{className:t.page,children:[e.jsx("h1",{className:t.title,children:a.title}),a.image?e.jsx("img",{src:a.image,alt:a.title||"Article image",className:t.image,width:"1225",height:"624",loading:"lazy"}):e.jsx("div",{className:t.noImagePlaceholder,children:"No image available"}),e.jsxs("div",{className:t.articleWrapper,children:[e.jsx("div",{className:t.contentBlock,children:e.jsx("div",{className:t.description,children:ue(a.article)})}),e.jsxs("aside",{className:t.sidebar,children:[e.jsxs("div",{className:t.metaRecommendationsContainer,children:[e.jsxs("div",{className:t.meta,children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Author:"})," ",a.ownerId?e.jsx(_,{to:`/authors/${a.ownerId}`,className:t.authorLink,children:a.author}):e.jsx("span",{className:t.authorLink,children:a.author||"Unknown author"})]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Publication date:"})," ",j]})]}),e.jsxs("div",{className:t.recommendations,children:[e.jsx("h3",{children:"You can also interested"}),N?e.jsx("p",{children:"Loading..."}):f.length===0?e.jsx("p",{children:"No recommendations available"}):e.jsx("ul",{className:t.recommendationsList,children:f.map(({_id:r,title:u,author:m,ownerId:v})=>e.jsxs("li",{className:t.recommendationItem,children:[e.jsxs("div",{className:t.recText,children:[e.jsx("p",{className:t.recTitle,children:u}),v?e.jsx(_,{to:`/authors/${v}`,className:t.recAuthor,children:m}):e.jsx("span",{className:t.recAuthor,children:m||"Unknown"})]}),e.jsx(_,{to:`/articles/${r}`,className:t.arrowButton,"aria-label":`Go to article ${u}`,children:e.jsx(he,{className:t.icon})})]},r))})]})]}),e.jsx(V,{onToggle:D,isDisabled:T,isSaved:p,isOwnArticle:b,onDelete:E,isLoadingDelete:B,className:t.saveButton})]})]})]})})]})};export{je as default};
