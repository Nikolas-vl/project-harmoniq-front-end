import{r as n,c as I,u as x,a as b,d as D,j as e,L as u,V as i}from"./index-DWWhECSa.js";import{g as E}from"./articlesApi-Bz247OV-.js";import{u as M}from"./useGetArticles-DRiM-e39.js";import{u as R,a as C,b as P,M as U,B as $}from"./useDeleteSavedArticle-C4ehht9c.js";import{u as F}from"./useLoader-DNjB8Sb9.js";const W="_saveButton_cvtwm_1",G="_page_cvtwm_21",O="_title_cvtwm_30",z="_image_cvtwm_37",V="_articleWrapper_cvtwm_46",H="_contentBlock_cvtwm_52",Y="_description_cvtwm_56",q="_sidebar_cvtwm_65",J="_metaRecommendationsContainer_cvtwm_72",K="_meta_cvtwm_72",Q="_authorLink_cvtwm_90",X="_recommendations_cvtwm_102",Z="_recommendationsList_cvtwm_109",ee="_recommendationItem_cvtwm_118",te="_recText_cvtwm_131",se="_recTitle_cvtwm_138",ae="_recAuthor_cvtwm_152",re="_arrowButton_cvtwm_165",ce="_icon_cvtwm_187",t={saveButton:W,page:G,title:O,image:z,articleWrapper:V,contentBlock:H,description:Y,sidebar:q,metaRecommendationsContainer:J,meta:K,authorLink:Q,recommendations:X,recommendationsList:Z,recommendationItem:ee,recText:te,recTitle:se,recAuthor:ae,arrowButton:re,icon:ce},ne=s=>{const[c,l]=n.useState(null),[a,d]=n.useState(!1);return n.useEffect(()=>{if(!s)return;(async()=>{d(!0);try{const o=await E(s);l(o.data.data.article)}catch(o){console.error("Failed to fetch article:",o)}finally{d(!1)}})()},[s]),{article:c,isLoading:a}},oe=s=>n.createElement("svg",{width:25,height:24,viewBox:"0 0 25 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...s},n.createElement("path",{d:"M5.375 19.125L19.6195 4.875M19.6195 4.875H11.948M19.6195 4.875L19.6196 12.5466",stroke:"#070721",strokeLinecap:"round",strokeLinejoin:"round"})),ie=s=>{if(!s)return null;const c=s.replaceAll("/n",`
`).replace(/\\n/g,`
`);return e.jsx("div",{style:{whiteSpace:"pre-wrap"},children:c})},ve=()=>{const{id:s}=I(),c=x(b),l=x(D),{article:a,isLoading:d}=ne(s),{articles:m=[]}=M({filter:"popular",limit:3});F(d);const{saveArticle:o,isLoading:j}=R(),{deleteArticle:f,isLoading:A}=C(),{remove:L,isLoading:N}=P(),[k,v]=n.useState(!1),h=n.useMemo(()=>l.includes(s),[l,s]),B=a?.ownerId===c,S=j||A,y=async()=>{if(!c){v(!0);return}try{h?(await f(c,s),i.success("Removed from saved!")):(await o(c,s),i.success("Saved!"))}catch(r){i.error("Something went wrong"),console.error(r)}},T=async()=>{try{await L(s),i.success("Article deleted!")}catch(r){console.error("Failed to delete:",r),i.error("Failed to delete article")}};if(!a)return e.jsx("p",{children:"Article not found"});let _="Unknown date";if(a.date){const r=new Date(a.date);isNaN(r)||(_=r.toLocaleDateString(void 0,{year:"numeric",month:"long",day:"numeric"}))}return e.jsxs(e.Fragment,{children:[e.jsx(U,{isOpen:k,onClose:()=>v(!1)}),e.jsx("div",{className:`container ${t.articlePage}`,children:e.jsxs("div",{className:t.page,children:[e.jsx("h1",{className:t.title,children:a.title}),a.image?e.jsx("img",{src:a.image,alt:a.title||"Article image",className:t.image,width:"1225",height:"624",loading:"lazy"}):e.jsx("div",{className:t.noImagePlaceholder,children:"No image available"}),e.jsxs("div",{className:t.articleWrapper,children:[e.jsx("div",{className:t.contentBlock,children:e.jsx("div",{className:t.description,children:ie(a.article)})}),e.jsxs("aside",{className:t.sidebar,children:[e.jsxs("div",{className:t.metaRecommendationsContainer,children:[e.jsxs("div",{className:t.meta,children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Author:"})," ",a.ownerId?e.jsx(u,{to:`/authors/${a.ownerId}`,className:t.authorLink,children:a.author}):e.jsx("span",{className:t.authorLink,children:a.author||"Unknown author"})]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Publication date:"})," ",_]})]}),e.jsxs("div",{className:t.recommendations,children:[e.jsx("h3",{children:"You can also interested"}),m.length===0?e.jsx("p",{children:"No recommendations available"}):e.jsx("ul",{className:t.recommendationsList,children:m.map(({_id:r,title:g,author:p,ownerId:w})=>e.jsxs("li",{className:t.recommendationItem,children:[e.jsxs("div",{className:t.recText,children:[e.jsx("p",{className:t.recTitle,children:g}),w?e.jsx(u,{to:`/authors/${w}`,className:t.recAuthor,children:p}):e.jsx("span",{className:t.recAuthor,children:p||"Unknown"})]}),e.jsx(u,{to:`/articles/${r}`,className:t.arrowButton,"aria-label":`Go to article ${g}`,children:e.jsx(oe,{className:t.icon})})]},r))})]})]}),e.jsx($,{onToggle:y,isDisabled:S,isSaved:h,isOwnArticle:B,onDelete:T,isLoadingDelete:N,styles:t.saveButton,text:h?"Remove from saved":"Save"})]})]})]})})]})};export{ve as default};
