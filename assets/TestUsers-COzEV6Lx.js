import{r as t,a as P,d as C,j as e,V as f}from"./index-BfrwJWzD.js";import{g as D,a as T,s as w}from"./usersApi-CaEohMhM.js";import{T as E}from"./TestNav-Crk29eTh.js";const N=(a=1,r=20)=>{const[o,d]=t.useState([]),[l,c]=t.useState(null),[u,n]=t.useState(!1);return t.useEffect(()=>{(async()=>{n(!0);try{const g=await D({page:a,perPage:r});d(g.data.users),c(g.data.paginationData)}catch(g){console.error("Failed to fetch users:",g)}finally{n(!1)}})()},[a,r]),{users:o,paginationData:l,isLoading:u}},k=a=>{const[r,o]=t.useState(null),[d,l]=t.useState([]),[c,u]=t.useState(!1);return t.useEffect(()=>{if(!a)return;(async()=>{u(!0);try{const i=await T(a);o(i.data.user),l(i.data.userArticles)}catch(i){console.error("Failed to fetch user info:",i)}finally{u(!1)}})()},[a]),{user:r,userArticles:d,isLoading:c}},F=()=>{const[a,r]=t.useState(!1);return{saveArticle:async(d,l)=>{r(!0);try{await w(d,l)}catch(c){throw console.error("Failed to save article:",c),c}finally{r(!1)}},isLoading:a}},V=()=>{const[a,r]=t.useState(1),[o,d]=t.useState(20),l=P(C),{users:c,isLoading:u,paginationData:n}=N(a,o),[i,g]=t.useState(""),[p,j]=t.useState(""),[h,m]=t.useState(""),[v,y]=t.useState(""),{user:x,userArticles:U,isLoading:I}=k(v),{saveArticle:A,isLoading:S}=F(),L=async()=>{if(!(!i||!p))try{await A(i,p),f.success("Article saved!")}catch{f.error("Error saving article.")}},b=()=>{h&&y(h)};return e.jsxs("div",{style:{padding:"1rem"},children:[e.jsx(E,{}),e.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:"1rem",alignItems:"center"},children:[e.jsxs("div",{style:{display:"flex",gap:"0.5rem",alignItems:"center"},children:[e.jsx("input",{placeholder:"User ID",value:i,onChange:s=>g(s.target.value)}),e.jsx("input",{placeholder:"Article ID",value:p,onChange:s=>j(s.target.value)}),e.jsx("button",{onClick:L,disabled:S,children:"Save Article"})]}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem",alignItems:"center"},children:[e.jsx("input",{placeholder:"User ID",value:h,onChange:s=>m(s.target.value)}),e.jsx("button",{onClick:b,disabled:!h,children:"Get User By ID"})]})]}),e.jsxs("p",{children:["Ur user id is ",l||"ur not loggin"]}),e.jsxs("div",{style:{marginTop:"2rem"},children:[e.jsxs("details",{children:[e.jsxs("summary",{style:{fontWeight:"bold"},children:["All Users (page ",n?.page||1," of"," ",n?.totalPages||1,")"]}),u?e.jsx("p",{children:"Loading users..."}):e.jsxs(e.Fragment,{children:[e.jsx("ul",{children:c.map(s=>e.jsxs("li",{children:[s.name," (",s._id,")"]},s._id))}),e.jsxs("div",{style:{marginTop:"1rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("button",{onClick:()=>r(s=>Math.max(s-1,1)),disabled:!n?.hasPreviousPage,children:"Prev"}),e.jsxs("label",{children:["Users per page:"," ",e.jsx("select",{value:o,onChange:s=>d(Number(s.target.value)),children:[6,12,24,48].map(s=>e.jsx("option",{value:s,children:s},s))})]}),e.jsx("button",{onClick:()=>r(s=>Math.min(s+1,n?.totalPages||s+1)),disabled:!n?.hasNextPage,children:"Next"})]})]})]}),e.jsx("h3",{children:"User Info"}),I?e.jsx("p",{children:"Loading user info..."}):x&&e.jsxs("div",{children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Name:"})," ",x.name]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Saved:"})," ",Array.isArray(x.saved)?x.saved.join(", "):""]}),e.jsx("h4",{children:"Articles:"}),e.jsx("ul",{children:U.map(s=>e.jsx("li",{children:s.title},s._id))})]})]})]})};export{V as default};
