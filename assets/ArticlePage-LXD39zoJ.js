import{r as n,b as D,c as E,u as j,s as M,d as R,j as e,L as h,V as l,e as u}from"./index-C7CNPM6o.js";import{g as C}from"./articlesApi-BVDwcZOc.js";import{u as U}from"./useGetArticles-DSqZBSHA.js";import{u as P,a as $,b as F,M as W,B as G}from"./useDeleteSavedArticle-BFYWoKtv.js";import{u as O}from"./useLoader-T_LZX2Yb.js";const z="_saveButton_cvtwm_1",V="_page_cvtwm_21",H="_title_cvtwm_30",Y="_image_cvtwm_37",q="_articleWrapper_cvtwm_46",J="_contentBlock_cvtwm_52",K="_description_cvtwm_56",Q="_sidebar_cvtwm_65",X="_metaRecommendationsContainer_cvtwm_72",Z="_meta_cvtwm_72",ee="_authorLink_cvtwm_90",te="_recommendations_cvtwm_102",se="_recommendationsList_cvtwm_109",ae="_recommendationItem_cvtwm_118",re="_recText_cvtwm_131",ce="_recTitle_cvtwm_138",ne="_recAuthor_cvtwm_152",oe="_arrowButton_cvtwm_165",ie="_icon_cvtwm_187",t={saveButton:z,page:V,title:H,image:Y,articleWrapper:q,contentBlock:J,description:K,sidebar:Q,metaRecommendationsContainer:X,meta:Z,authorLink:ee,recommendations:te,recommendationsList:se,recommendationItem:ae,recText:re,recTitle:ce,recAuthor:ne,arrowButton:oe,icon:ie},le=a=>{const[c,o]=n.useState(null),[d,s]=n.useState(!1);return n.useEffect(()=>{if(!a)return;(async()=>{s(!0);try{const i=await C(a);o(i.data.data.article)}catch(i){console.error("Failed to fetch article:",i)}finally{s(!1)}})()},[a]),{article:c,isLoading:d}},de=a=>n.createElement("svg",{width:25,height:24,viewBox:"0 0 25 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...a},n.createElement("path",{d:"M5.375 19.125L19.6195 4.875M19.6195 4.875H11.948M19.6195 4.875L19.6196 12.5466",stroke:"#070721",strokeLinecap:"round",strokeLinejoin:"round"})),me=a=>{if(!a)return null;const c=a.replaceAll("/n",`
`).replace(/\\n/g,`
`);return e.jsx("div",{style:{whiteSpace:"pre-wrap"},children:c})},pe=()=>{const{id:a}=D(),c=E(),o=j(M),d=j(R),{article:s,isLoading:v}=le(a),{articles:i=[]}=U({filter:"popular",limit:3});O(v);const{saveArticle:f,isLoading:A}=P(),{deleteArticle:L,isLoading:N}=$(),{remove:k,isLoading:B}=F(),[S,_]=n.useState(!1),m=n.useMemo(()=>d.includes(a),[d,a]),y=s?.ownerId===o,T=A||N,b=async()=>{if(!o){_(!0);return}try{m?(await L(o,a),l.success("Removed from saved!"),c(u())):(await f(o,a),l.success("Saved!"),c(u()))}catch(r){l.error("Something went wrong"),console.error(r)}},I=async()=>{try{await k(a),l.success("Article deleted!"),c(u())}catch(r){console.error("Failed to delete:",r),l.error("Failed to delete article")}};if(!s)return e.jsx("p",{children:"Article not found"});let g="Unknown date";if(s.date){const r=new Date(s.date);isNaN(r)||(g=r.toLocaleDateString(void 0,{year:"numeric",month:"long",day:"numeric"}))}return e.jsxs(e.Fragment,{children:[e.jsx(W,{isOpen:S,onClose:()=>_(!1)}),e.jsx("div",{className:`container ${t.articlePage}`,children:e.jsxs("div",{className:t.page,children:[e.jsx("h1",{className:t.title,children:s.title}),s.image?e.jsx("img",{src:s.image,alt:s.title||"Article image",className:t.image,width:"1225",height:"624",loading:"lazy"}):e.jsx("div",{className:t.noImagePlaceholder,children:"No image available"}),e.jsxs("div",{className:t.articleWrapper,children:[e.jsx("div",{className:t.contentBlock,children:e.jsx("div",{className:t.description,children:me(s.article)})}),e.jsxs("aside",{className:t.sidebar,children:[e.jsxs("div",{className:t.metaRecommendationsContainer,children:[e.jsxs("div",{className:t.meta,children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Author:"})," ",s.ownerId?e.jsx(h,{to:`/authors/${s.ownerId}`,className:t.authorLink,children:s.author}):e.jsx("span",{className:t.authorLink,children:s.author||"Unknown author"})]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Publication date:"})," ",g]})]}),e.jsxs("div",{className:t.recommendations,children:[e.jsx("h3",{children:"You can also interested"}),i.length===0?e.jsx("p",{children:"No recommendations available"}):e.jsx("ul",{className:t.recommendationsList,children:i.map(({_id:r,title:p,author:w,ownerId:x})=>e.jsxs("li",{className:t.recommendationItem,children:[e.jsxs("div",{className:t.recText,children:[e.jsx("p",{className:t.recTitle,children:p}),x?e.jsx(h,{to:`/authors/${x}`,className:t.recAuthor,children:w}):e.jsx("span",{className:t.recAuthor,children:w||"Unknown"})]}),e.jsx(h,{to:`/articles/${r}`,className:t.arrowButton,"aria-label":`Go to article ${p}`,children:e.jsx(de,{className:t.icon})})]},r))})]})]}),e.jsx(G,{onToggle:b,isDisabled:T,isSaved:m,isOwnArticle:y,onDelete:I,isLoadingDelete:B,styles:t.saveButton,text:m?"Remove from saved":"Save"})]})]})]})})]})};export{pe as default};
