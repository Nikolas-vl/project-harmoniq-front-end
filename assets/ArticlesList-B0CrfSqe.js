import{j as e,u as L,L as y,v as C,r as u,f as M,a as j,w as A,d as b,t as W,V as v}from"./index-B5RJ0QI6.js";import{d as S}from"./articlesApi-BV6d_WdY.js";import{u as E}from"./useSaveArticle-CqJE99UA.js";const T="_saveBtn_t1qe5_1",$="_active_t1qe5_18",f={saveBtn:T,active:$},F=({onAdd:s,isSaved:n})=>e.jsx("button",{className:`${f.saveBtn} ${n?f.active:""}`,onClick:s,children:e.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{d:"M11.9971 3.5C13.2607 3.50001 14.4206 3.62091 15.3398 3.76074C16.5036 3.93777 17.416 4.7353 17.6758 5.84961C17.9894 7.19485 18.2969 9.24141 18.2441 11.9902C18.1859 15.0233 17.7432 17.2117 17.3164 18.6396C17.201 19.0256 16.9339 19.2243 16.6318 19.2754C16.316 19.3287 15.9263 19.2236 15.6094 18.9082C15.0326 18.334 14.3719 17.7138 13.7627 17.2344C13.4586 16.9951 13.1558 16.7817 12.875 16.626C12.6101 16.4791 12.2995 16.3457 11.9971 16.3457C11.6993 16.3457 11.3783 16.4769 11.0977 16.6211C10.7986 16.7747 10.4675 16.9855 10.1289 17.2246C9.45038 17.7037 8.69895 18.3244 8.03711 18.8994C7.68779 19.2029 7.27644 19.2747 6.95215 19.1865C6.63917 19.1013 6.37522 18.8609 6.29395 18.4424C6.01488 17.0044 5.75 14.8805 5.75 12C5.75 9.12652 6.04615 7.09969 6.34082 5.79492C6.58505 4.71356 7.4671 3.94375 8.60156 3.76855C9.52893 3.62535 10.7091 3.5 11.9971 3.5Z",stroke:"#374F42",strokeLinecap:"round",strokeLinejoin:"round"})})}),R="_articleContainer_18o2j_1",q="_textWrap_18o2j_8",z="_articleImg_18o2j_13",D="_authorInfo_18o2j_20",U="_titleInfo_18o2j_26",V="_description_18o2j_32",Z="_buttonWrap_18o2j_41",O="_learnMoreBtn_18o2j_46",G="_deleteBtn_18o2j_61",H="_icon_18o2j_78",r={articleContainer:R,textWrap:q,articleImg:z,authorInfo:D,titleInfo:U,description:V,buttonWrap:Z,learnMoreBtn:O,deleteBtn:G,icon:H},J=({article_id:s,author:n,title:l,description:c,img:d,handleAdd:a,isSaved:o,isOwnProfile:h,activeTab:m})=>{const p=L(),x=async()=>{try{await S(s),p({type:"auth/removeUserArticle",payload:s}),C.success("Article deleted!")}catch(g){console.error("Failed to delete:",g),C.error("Failed to delete article")}};return e.jsxs("article",{className:r.articleContainer,children:[e.jsxs("picture",{children:[e.jsx("source",{media:"(min-width: 1440px)",srcSet:d,width:"368",height:"233"}),e.jsx("img",{src:d,alt:"photo here",width:337,height:233,className:r.articleImg})]}),e.jsxs("div",{className:r.textWrap,children:[e.jsx("h3",{className:r.authorInfo,children:n}),e.jsx("h3",{className:r.titleInfo,children:l}),e.jsx("p",{className:r.description,children:c})]}),e.jsxs("div",{className:r.buttonWrap,children:[e.jsx(y,{to:`/articles/${s}`,className:r.learnMoreBtn,children:"Learn more"}),h&&m==="my"?e.jsx("button",{className:r.deleteBtn,onClick:x,children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.8",className:r.icon,children:[e.jsx("path",{d:"M3.03919 4.2939C3.01449 4.10866 3.0791 3.92338 3.23133 3.81499C3.9272 3.31953 6.3142 2 12 2C17.6858 2 20.0728 3.31952 20.7687 3.81499C20.9209 3.92338 20.9855 4.10866 20.9608 4.2939L19.2616 17.0378C19.0968 18.2744 18.3644 19.3632 17.2813 19.9821L16.9614 20.1649C13.8871 21.9217 10.1129 21.9217 7.03861 20.1649L6.71873 19.9821C5.6356 19.3632 4.90325 18.2744 4.73838 17.0378L3.03919 4.2939Z"}),e.jsx("path",{d:"M3 5C5.57143 7.66666 18.4286 7.66662 21 5"})]})}):e.jsx(F,{onAdd:()=>a(s),isSaved:o})]})]})},K="_list_10osf_1",P="_listItem_10osf_7",w={list:K,listItem:P},Q="_overlay_c61rp_1",X="_content_c61rp_12",Y="_errorTitle_c61rp_22",ee="_icon_c61rp_29",te="_textModalWrapper_c61rp_35",se="_btns_c61rp_40",ne="_loginBtn_c61rp_45",oe="_registerBtn_c61rp_56",i={overlay:Q,content:X,errorTitle:Y,icon:ee,textModalWrapper:te,btns:se,loginBtn:ne,registerBtn:oe},re=({isOpen:s,onClose:n})=>{u.useEffect(()=>{const o=h=>{h.key==="Escape"&&n()};return document.addEventListener("keydown",o),()=>document.removeEventListener("keydown",o)},[n]);const l=M();if(!s)return null;const c=()=>{l("/login")},d=()=>{l("/register")},a=o=>{o.target===o.currentTarget&&n()};return e.jsx("div",{className:i.overlay,onClick:a,children:e.jsxs("div",{className:i.content,children:[e.jsx("button",{onClick:n,children:e.jsx("svg",{className:i.icon,width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{d:"M5.25 5.25L12 12M12 12L5.25 18.75M12 12L18.75 18.75M12 12L18.75 5.25",stroke:"#070721",strokeLinecap:"round",strokeLinejoin:"round"})})}),e.jsxs("div",{className:i.textModalWrapper,children:[e.jsx("h2",{className:i.errorTitle,children:"Error while saving"}),e.jsx("p",{className:i.errorText,children:"To save this article, you need to authorize first"}),e.jsxs("div",{className:i.btns,children:[e.jsx("button",{onClick:c,className:i.loginBtn,children:"Login"}),e.jsx("button",{onClick:d,className:i.registerBtn,children:"Register"})]})]})]})})},le=({articles:s,isOwnProfile:n,activeTab:l})=>{const c=j(A),d=j(b),a=j(W),[o,h]=u.useState([]),[m,p]=u.useState(!1),{saveArticle:x}=E();u.useEffect(()=>{c&&a&&h(a.map(t=>t._id))},[c,a]);const g=async t=>{if(!c){p(!0);return}if(o.includes(t)){v("Already in favourites!");return}try{await x(d,t),h(_=>[..._,t]),v.success("Saved!")}catch(_){console.error("Failed to save:",_),v.error("Something went wrong")}},B=s.map(t=>{const _=t._id||t.article_id,I=typeof t.author=="object"&&t.author!==null?t.author.name:typeof t.author=="string"?"Автор":"Невідомо",k=t.img||t.image||"",N=t.description||t.desc||"";return{article_id:_,title:t.title,description:N,author:I,img:k}});return e.jsxs(e.Fragment,{children:[e.jsx("ul",{className:w.list,children:B.map(t=>e.jsx("li",{className:w.listItem,children:e.jsx(J,{title:t.title,description:t.description,author:t.author,img:t.img,handleAdd:g,article_id:t.article_id,isOwnProfile:n,activeTab:l,isSaved:o.includes(t.article_id)})},t.article_id))}),e.jsx(re,{isOpen:m,onClose:()=>p(!1)})]})};export{le as A};
