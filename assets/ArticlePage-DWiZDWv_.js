import{r as n,h as M,u as R,a as v,d as C,i as U,j as e,k as P,L as u,V as c,m as _}from"./index-FuH_kWGc.js";import{u as $}from"./useGetArticleById-EkNmaifL.js";import{u as G}from"./useSaveArticle-DgIpWPoy.js";import{u as O,a as W,M as F,B as V}from"./useDeleteSavedArticle-BdYH4aNY.js";import{u as z}from"./useGetUserInfo-D1nSqrG9.js";import"./articlesApi-D8U5pHHY.js";import"./usersApi-xHuqhiyv.js";const H="_page_yy2ql_1",Y="_title_yy2ql_10",J="_image_yy2ql_17",K="_articleWrapper_yy2ql_26",Q="_contentBlock_yy2ql_32",X="_description_yy2ql_36",Z="_sidebar_yy2ql_44",ee="_metaRecommendationsContainer_yy2ql_53",se="_meta_yy2ql_53",te="_authorLink_yy2ql_68",ae="_recommendations_yy2ql_80",re="_recommendationsList_yy2ql_87",oe="_recommendationItem_yy2ql_96",ne="_recText_yy2ql_113",ie="_recTitle_yy2ql_120",ce="_recAuthor_yy2ql_134",le="_arrowButton_yy2ql_147",de="_icon_yy2ql_171",s={page:H,title:Y,image:J,articleWrapper:K,contentBlock:Q,description:X,sidebar:Z,metaRecommendationsContainer:ee,meta:se,authorLink:te,recommendations:ae,recommendationsList:re,recommendationItem:oe,recText:ne,recTitle:ie,recAuthor:ce,arrowButton:le,icon:de},me=a=>n.createElement("svg",{width:25,height:24,viewBox:"0 0 25 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...a},n.createElement("path",{d:"M5.375 15.125L19.6195 0.875M19.6195 0.875H11.948M19.6195 0.875L19.6196 8.5466",stroke:"#070721",strokeLinecap:"round",strokeLinejoin:"round"})),he=a=>a.split("/n").map((i,o)=>e.jsxs("span",{children:[i.trim(),e.jsx("br",{})]},o)),ue=3,ve=()=>{const{id:a}=M(),i=R(),o=v(C),g=v(U),{article:t,isLoading:N}=$(a),{articles:d=[],isLoading:L}=useGetPopularArticles(8);z(o);const{saveArticle:w,isLoading:A}=G(),{deleteArticle:k,isLoading:q}=O(),{remove:S,isLoading:B}=W(),[p,m]=n.useState(!1),[T,x]=n.useState(!1);n.useEffect(()=>{m(g.some(r=>r===a))},[g,a]);const I=t?.ownerId===o,y=n.useMemo(()=>d.length?d.filter(l=>l._id!==a).sort(()=>.5-Math.random()).slice(0,ue):[],[d,a]),b=A||q,D=async()=>{if(!o){x(!0);return}try{p?(await k(o,a),m(!1),c.success("Removed from saved!"),i(_())):(await w(o,a),m(!0),c.success("Saved!"),i(_()))}catch(r){c.error("Something went wrong"),console.error(r)}},E=async()=>{try{await S(a),c.success("Article deleted!"),i(_())}catch(r){console.error("Failed to delete:",r),c.error("Failed to delete article")}};if(N)return e.jsx(P,{fullScreen:!0});if(!t)return e.jsx("p",{children:"Article not found"});let j="Unknown date";if(t.date){const r=new Date(t.date);isNaN(r)||(j=r.toLocaleDateString(void 0,{year:"numeric",month:"long",day:"numeric"}))}return e.jsxs(e.Fragment,{children:[e.jsx(F,{isOpen:T,onClose:()=>x(!1)}),e.jsx("div",{className:`container ${s.articlePage}`,children:e.jsxs("div",{className:s.page,children:[e.jsx("h1",{className:s.title,children:t.title}),t.image?e.jsx("img",{src:t.image,alt:t.title||"Article image",className:s.image,width:"1225",height:"624",loading:"lazy"}):e.jsx("div",{className:s.noImagePlaceholder,children:"No image available"}),e.jsxs("div",{className:s.articleWrapper,children:[e.jsx("div",{className:s.contentBlock,children:e.jsx("div",{className:s.description,children:he(t.article)})}),e.jsxs("aside",{className:s.sidebar,children:[e.jsxs("div",{className:s.metaRecommendationsContainer,children:[e.jsxs("div",{className:s.meta,children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Author:"})," ",t.ownerId?e.jsx(u,{to:`/authors/${t.ownerId}`,className:s.authorLink,children:t.author}):e.jsx("span",{className:s.authorLink,children:t.author||"Unknown author"})]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Publication date:"})," ",j]})]}),e.jsxs("div",{className:s.recommendations,children:[e.jsx("h3",{children:"You can also interested"}),L?e.jsx("p",{children:"Loading..."}):y.length===0?e.jsx("p",{children:"No recommendations available"}):e.jsx("ul",{className:s.recommendationsList,children:y.map(({_id:r,title:h,author:l,ownerId:f})=>e.jsxs("li",{className:s.recommendationItem,children:[e.jsxs("div",{className:s.recText,children:[e.jsx("p",{className:s.recTitle,children:h}),f?e.jsx(u,{to:`/authors/${f}`,className:s.recAuthor,children:l}):e.jsx("span",{className:s.recAuthor,children:l||"Unknown"})]}),e.jsx(u,{to:`/articles/${r}`,className:s.arrowButton,"aria-label":`Go to article ${h}`,children:e.jsx(me,{className:s.icon})})]},r))})]})]}),e.jsx(V,{onToggle:D,isDisabled:b,isSaved:p,isOwnArticle:I,onDelete:E,isLoadingDelete:B,className:s.saveButton})]})]})]})})]})};export{ve as default};
