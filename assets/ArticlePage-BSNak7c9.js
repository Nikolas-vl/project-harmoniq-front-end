import{r as n,h as M,u as R,a as v,d as C,i as U,j as e,k as P,L as u,V as c,m as _}from"./index-DQwv4Li6.js";import{u as $}from"./useGetArticleById-BYcXzYeA.js";import{u as G}from"./useGetPopularArticles-Dan2HLh-.js";import{u as O}from"./useSaveArticle--ryON5vI.js";import{u as W,a as F,M as V,B as z}from"./useDeleteSavedArticle-B4LIdyq5.js";import{u as H}from"./useGetUserInfo-DI1RxnC8.js";import"./articlesApi-CJ8CWx5i.js";import"./usersApi-BsB_89oh.js";const Y="_page_yy2ql_1",J="_title_yy2ql_10",K="_image_yy2ql_17",Q="_articleWrapper_yy2ql_26",X="_contentBlock_yy2ql_32",Z="_description_yy2ql_36",ee="_sidebar_yy2ql_44",se="_metaRecommendationsContainer_yy2ql_53",te="_meta_yy2ql_53",ae="_authorLink_yy2ql_68",re="_recommendations_yy2ql_80",oe="_recommendationsList_yy2ql_87",ne="_recommendationItem_yy2ql_96",ie="_recText_yy2ql_113",ce="_recTitle_yy2ql_120",le="_recAuthor_yy2ql_134",de="_arrowButton_yy2ql_147",me="_icon_yy2ql_171",s={page:Y,title:J,image:K,articleWrapper:Q,contentBlock:X,description:Z,sidebar:ee,metaRecommendationsContainer:se,meta:te,authorLink:ae,recommendations:re,recommendationsList:oe,recommendationItem:ne,recText:ie,recTitle:ce,recAuthor:le,arrowButton:de,icon:me},he=a=>n.createElement("svg",{width:25,height:24,viewBox:"0 0 25 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...a},n.createElement("path",{d:"M5.375 15.125L19.6195 0.875M19.6195 0.875H11.948M19.6195 0.875L19.6196 8.5466",stroke:"#070721",strokeLinecap:"round",strokeLinejoin:"round"})),ue=a=>a.split("/n").map((i,o)=>e.jsxs("span",{children:[i.trim(),e.jsx("br",{})]},o)),_e=3,Le=()=>{const{id:a}=M(),i=R(),o=v(C),g=v(U),{article:t,isLoading:N}=$(a),{articles:d=[],isLoading:L}=G(8);H(o);const{saveArticle:w,isLoading:A}=O(),{deleteArticle:k,isLoading:q}=W(),{remove:S,isLoading:B}=F(),[p,m]=n.useState(!1),[T,x]=n.useState(!1);n.useEffect(()=>{m(g.some(r=>r===a))},[g,a]);const I=t?.ownerId===o,y=n.useMemo(()=>d.length?d.filter(l=>l._id!==a).sort(()=>.5-Math.random()).slice(0,_e):[],[d,a]),b=A||q,D=async()=>{if(!o){x(!0);return}try{p?(await k(o,a),m(!1),c.success("Removed from saved!"),i(_())):(await w(o,a),m(!0),c.success("Saved!"),i(_()))}catch(r){c.error("Something went wrong"),console.error(r)}},E=async()=>{try{await S(a),c.success("Article deleted!"),i(_())}catch(r){console.error("Failed to delete:",r),c.error("Failed to delete article")}};if(N)return e.jsx(P,{fullScreen:!0});if(!t)return e.jsx("p",{children:"Article not found"});let j="Unknown date";if(t.date){const r=new Date(t.date);isNaN(r)||(j=r.toLocaleDateString(void 0,{year:"numeric",month:"long",day:"numeric"}))}return e.jsxs(e.Fragment,{children:[e.jsx(V,{isOpen:T,onClose:()=>x(!1)}),e.jsx("div",{className:`container ${s.articlePage}`,children:e.jsxs("div",{className:s.page,children:[e.jsx("h1",{className:s.title,children:t.title}),t.image?e.jsx("img",{src:t.image,alt:t.title||"Article image",className:s.image,width:"1225",height:"624",loading:"lazy"}):e.jsx("div",{className:s.noImagePlaceholder,children:"No image available"}),e.jsxs("div",{className:s.articleWrapper,children:[e.jsx("div",{className:s.contentBlock,children:e.jsx("div",{className:s.description,children:ue(t.article)})}),e.jsxs("aside",{className:s.sidebar,children:[e.jsxs("div",{className:s.metaRecommendationsContainer,children:[e.jsxs("div",{className:s.meta,children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Author:"})," ",t.ownerId?e.jsx(u,{to:`/authors/${t.ownerId}`,className:s.authorLink,children:t.author}):e.jsx("span",{className:s.authorLink,children:t.author||"Unknown author"})]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Publication date:"})," ",j]})]}),e.jsxs("div",{className:s.recommendations,children:[e.jsx("h3",{children:"You can also interested"}),L?e.jsx("p",{children:"Loading..."}):y.length===0?e.jsx("p",{children:"No recommendations available"}):e.jsx("ul",{className:s.recommendationsList,children:y.map(({_id:r,title:h,author:l,ownerId:f})=>e.jsxs("li",{className:s.recommendationItem,children:[e.jsxs("div",{className:s.recText,children:[e.jsx("p",{className:s.recTitle,children:h}),f?e.jsx(u,{to:`/authors/${f}`,className:s.recAuthor,children:l}):e.jsx("span",{className:s.recAuthor,children:l||"Unknown"})]}),e.jsx(u,{to:`/articles/${r}`,className:s.arrowButton,"aria-label":`Go to article ${h}`,children:e.jsx(he,{className:s.icon})})]},r))})]})]}),e.jsx(z,{onToggle:D,isDisabled:b,isSaved:p,isOwnArticle:I,onDelete:E,isLoadingDelete:B,className:s.saveButton})]})]})]})})]})};export{Le as default};
